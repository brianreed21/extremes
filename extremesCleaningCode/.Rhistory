library(tidyr);library(tidyverse)
library(prism);library(raster);library(ggplot2);library(dplyr);library(raster);library(sp)
hq = read.csv("~/Documents/supplyChain/data/companyHQZips.csv") %>% select(year,gvkey,state,latitude,longitude)
hq = read.csv("~/Documents/supplyChain/data/companyHQZips.csv")
head(hq)
hq.spdf = SpatialPointsDataFrame(coords=hq[,c('longitude','latitude')],
data=hq, proj4string = CRS("+proj=longlat +ellps=WGS84 +no_defs"))
geoHQ.temp <- raster::extract(RS, hq.spdf,  fun=mean, na.rm=TRUE, sp=TRUE)
hq.spdf
year = 2010
# first do this for precipitation data
print(year)
prism_set_dl_dir("~/Documents/supplyChain/data/prism/prism_precip")
precip = prism_archive_ls()[grepl(paste0("_",year),prism_archive_ls())]
# get a raster stack of all the climate data
RS              <- pd_stack(precip) ##raster file of data
proj4string(RS) <- CRS("+proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs") ##assign projection info
# slice the raster stack to get the climate data around the hq
geoHQ.precip <- raster::extract(RS, hq.spdf,  fun=mean, na.rm=TRUE, sp=TRUE)
# grab the precipitation data and reformat it so that we have values, for each year for the hq in a given row
hqWeather = geoHQ.precip@data %>% gather(month,precipitation,7:ncol(geoHQ.precip@data)) %>%
separate(month, c(NA,'variable',NA,NA,'date',NA), "_") %>% mutate(weatherYear = substr(date,0,4),
weatherMonth = substr(date,5,6)) %>% filter(weatherYear == archive_version_year)
library(tidyr);library(tidyverse)
library(prism);library(raster);library(ggplot2);library(dplyr);library(raster);library(sp)
year = 2010
prism_set_dl_dir("~/Documents/supplyChain/data/prism/prism_precip")
precip = prism_archive_ls()[grepl(paste0("_",year),prism_archive_ls())]
RS              <- pd_stack(precip) ##raster file of data
proj4string(RS) <- CRS("+proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs") ##assign projection info
library(rgdal)
install.packages('rgdal')
library(rgdal)
RS              <- pd_stack(precip) ##raster file of data
precip
library(tidyr);library(tidyverse)
library(prism);library(raster);library(ggplot2);library(dplyr);library(raster);library(sp)
library(tidyr);library(tidyverse)
library(prism);library(raster);library(ggplot2);library(dplyr);library(raster);library(sp)
prism_set_dl_dir("~/Documents/supplyChain/data/prism/prism_precip")
# prism_set_dl_dir("~/Volumes/backup2/dissData/prismTemp/prism_temp")
get_prism_dailys(
type = "ppt",
minDate = "2000-01-01",
maxDate = "2019-12-31",
keepZip = FALSE
)
get_prism_dailys(
type = "ppt",
minDate = "2002-01-11",
maxDate = "2019-12-31",
keepZip = FALSE
)
prism_set_dl_dir("~/Documents/supplyChain/data/prism/prism_temp")
get_prism_dailys(
type = "tmax",
minDate = "2000-01-01",
maxDate = "2019-12-31",
keepZip = FALSE
)
prism_set_dl_dir("~/Documents/supplyChain/data/prism/prism_temp")
get_prism_dailys(
type = "tmax",
minDate = "2013-09-15",
maxDate = "2019-12-31",
keepZip = FALSE
)
prism_set_dl_dir("~/Documents/supplyChain/data/prism1/prism_precip")
# prism_set_dl_dir("~/Volumes/backup2/dissData/prismTemp/prism_temp")
get_prism_dailys(
type = "ppt",
minDate = "1895-01-01",
maxDate = "1925-12-31",
keepZip = FALSE
)
